---
title: 静态库与动态库的制作与使用
date: 2022-011-14 21:10:30
tags: linux
categories: linux
---

# 静态库制作与使用

静态库以.a后缀结尾，制作方法如下：

```
libxxx.a:xx.o xx.o xx.o
	ar -rc $@ $^       //直接打包
	
%.o:%.c
	gcc -c $<                          
```

当需要使用静态库时，如下编译：

```
gcc -o $@ $^ -l头文件路径 -L库路径 -l库名   
```

# 动态库制作与使用

静态库以.so后缀结尾，制作方法如下：

```
libxxx.so:xx.o xx.o
	gcc -shared -o $@ $^ 

%.o:%.c
	gcc -fPIC -c $<   //-fPIC全部生成绝对地址，因为动态库用的时候才调用
```

当需要使用动态库时，有如下方法：

- 首先先编译：

  ```
  gcc -o $@ $ -I+头文件路径 -L+库路径 -l+库名
  ```

- 需要更改LD_LIBRARY_PATH环境变量路径
- 或者将.so文件拷贝到系统共享库目录下，一般是/usr/lib
- ldconfig 配置/etc/ld.so.conf.d/, ldconfig更新

